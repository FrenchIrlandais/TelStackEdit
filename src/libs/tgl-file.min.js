function y(r){return new TextEncoder("utf-8").encode(r)}function A(r){return(new TextDecoder).decode(r)}function r(r){for(var t=new Uint8Array(8),i="",e=0;e<r.byteLength;e++){p(r[e],t,0);for(var s=0,n=0,o=0;o<4;o++)s=2*s+t[o],n=2*n+t[4+o];i+=s.toString(16)+n.toString(16)}return i}function p(r,t,i){for(var e=0;e<8;e++)t[i+(7-e)]=r%2,r=~~(r/2)}"undefined"!=typeof exports&&(exports.t=y,exports.i=A,exports.o=r,exports.h=p);class t{u=128;l=16;constructor(r){this.v=[],this.A=[],this.p=[];for(var t=0;t<this.u;t++)this.v.push(0),this.A.push(0);for(t=0;t<2*this.u+1;t++)this.p.push(0);for(var i=r%1,t=0;t<this.v.length;t++)this.v[t]=~~(i*=2),i-=this.v[t]}U(r){if(r.length!=this.u)throw new Error("Critical error !");for(var t=0;t<this.u;t++){if(0!==r[t]&&1!==r[t])throw new Error("Critical error !");this.v[t]=r[t]}}C(r){if(r.length!=this.u/8)throw new Error("Critical error !");for(var t=0;t<this.u/8;t++)p(r[t],this.v,8*t)}g(r,t){for(var i=y(r),e=[],s=0;s<i.length;s++)p(i[s],e,8*s);0==e.length&&e.push(1);for(s=e.length;s<this.v.length;s++){var n=e[~~(s/2)],o=e[s-(1+~~(s/8))],h=1-e[~~(s/7)];e.push((n+o+h)%2)}for(s=0;s<this.v.length;s++)this.v[s]=0;for(s=0;s<e.length;s++)this.v[s%this.v.length]+=e[s],this.v[s%this.v.length]=this.v[s%this.v.length]%2;for(s=0;s<100;s++)this.T(this.l);for(s=0;s<this.v.length;s++)this.v[s]=(this.v[s]+t[s])%2}random(){return this.T(this.l),i(this.v)}m(){return this.T(this.l),e(this.v)}M(){this.T(this.l);for(var r=0,t=0;t<10;t++)r+=this.v[t]*Math.pow(2,t);return r}T(r){for(var t=!0,i=0;i<this.u;i++)t=t&&0==this.v[i];if(t)for(i=0;i<this.u;i++)i%7!=0&&i%3!=0||(this.v[i]=1);for(i=0;i<this.u;i++)this.A[i]=1-this.v[i];for(i=this.u-1;0<=i&&(this.A[i]=1-this.A[i],0==this.A[i]);i--);for(i=0;i<this.p.length;i++)this.p[i]=0;for(var e=this.u-1;0<=e;e--)if(0!=this.v[e]){for(var s=0,i=this.u-1;0<=i;i--){var n=this.p[e+i]+s+this.A[i];this.p[e+i]=n%2,s=~~(n/2)}if(0!=s)for(i=-1;-e<=i&&(this.p[e+i]=1-this.p[e+i],0==this.p[e+i]);i--);}for(i=0;i<this.u;i++)this.v[i]=this.p[i+1+r]}}function i(r){for(var t=0,i=0;i<r.length;i++)t+=r[i]*Math.pow(2,-1*(i+1));return t}function e(r){for(var t=0,i=0;i<8;i++)t+=r[i]*Math.pow(2,i);return t}var y,A,r,p;"undefined"!=typeof exports&&(exports.constructor=t);var E=t;function a(r,t,i,e){t=(t[i]+r+256)%256;return e.push(t),i+1}function s(r,t,i,e){t=(t[i]-r+256)%256;return e.push(t),i+1}function n(r,t,i,e){return t[i]<32||127==t[i]?e.push(t[i]):(r=(t=(t[i]+r+256)%256)%95+32,e.push(t/95+32),e.push(r)),i+1}function o(r,t,i,e){var s;return t[i]<32||127==t[i]?(e.push(t[i]),i+1):(s=t[i],t=t[i+1],e.push((95*(s-32)+(t-32)-r+256)%256),i+2)}class h{name="UNKNOWN";N=0;constructor(r,t){this.name=r,this.N=t}equals(r){return this.N==r.N}S(){if(this.N==f.N)return a;if(this.N==u.N)return n;throw new Error("Critical error !")}F(){if(this.N==f.N)return s;if(this.N==u.N)return o;throw new Error("Critical error !")}}const f=new h("BINARY",66),u=new h("VERSIONING",86);function c(r){if(r==f.N)return f;if(r==u.N)return u;throw new Error("Critical error !")}class w{name="UNKNOWN";N=0;I=[48];constructor(r,t,i){this.name=r,this.N=t,this.I=i}equals(r){return this.N==r.N}B(){return this.I[this.I.length-1]}G(r){if(-1==this.I.indexOf(r))throw new Error("Critical error !");return new w(this.name,this.N,[r])}}const U=new w("ZDF",90,[48]),l=new w("ESV",69,[48]);function x(r,t){return r==U.N?U.G(t):r==l.N?l.G(t):void 0}var d=[l],v=[U,l];function C(r){var t=~~(r/8);if(!(1<=t)||t!=r/8)throw new Error("Critical error !");for(var i=new Uint8Array(t),e=new Uint8Array(r),s=0;s<t;s++){var n=~~(256*Math.random());i[s]=n,p(n,e,8*s)}return{H:e,k:i}}class g{constructor(r){this.q=r}P(r,t,i,e){if(!(65535<i)){var s=i/256,i=i%256;if(r.equals(U)){if(t.equals(f))return e.push(r.N),e.push(r.B()),e.push(s),void e.push(i)}else if(r.equals(l)&&(t.equals(f)||t.equals(u)))return e.push(r.N),e.push(r.B()),e.push(s),e.push(i),void e.push(t.N)}throw new Error("Critical error !")}D(r,t,i){if(t.equals(U))return f;if(t.equals(l)){t=c(r[4]);if(t.equals(f)||t.equals(u))return i[0]=i[0]+1,t}throw new Error("Critical error !")}R(r,i,e,s,n,o){httpGetAsArrayBuffer(r,(r,t)=>{o(200!==t?y("Could not retrieve "+url+" file. HTTP GET error "+t+"."):this.encode(r,i,e,s,n))})}encode(r,t,i,e,s){for(var n=[],o=y(t),h=(this.P(e,s,o.length,n),n.length,new E(0)),a=h.u/8,f=new Uint8Array(a),u=new Uint8Array(h.u),c=0;c<a;c++){var w=~~(256*Math.random());f[c]=w,p(w,u,8*c)}h.g(i,u);for(c=0;c<a;c++)n.push(f[c]);for(var l=0,d=s.S(),c=0;c<o.length;)l=(l+h.M())%this.q.length,c=d(this.q[l],o,c,n);for(c=0;c<r.byteLength;)l=(l+h.M())%this.q.length,c=d(this.q[l],r,c,n);return new Uint8Array(n)}V(r,i,e,s){httpGetAsArrayBuffer(r,(r,t)=>{s(200!==t?y("Could not retrieve "+url+" file. HTTP GET error "+t+"."):this.decode(r,i,e))})}decode(r,t,i){var e=[4],s=x(r[0],r[1]),n=256*r[2]+r[3],o=(null==s&&(s=U,n=e[0]=0),!1);if(i.forEach(r=>{s.equals(r)&&(o=!0)}),!o)throw new Error("Critical error !");for(var i=this.D(r,s,e),h=e[0],a=new E(0),f=a.u/8,u=new Uint8Array(a.u),c=0;c<f;c++)p(r[h],u,8*c),h++;a.g(t,u);for(var w=0,l=i.F(),d=[],c=0;c<n;c++)w=(w+a.M())%this.q.length,h=l(this.q[w],r,h,d);0==n&&(d=y("default.txt"));for(var v=[];h<r.byteLength;)w=(w+a.M())%this.q.length,h=l(this.q[w],r,h,v);return{filename:A(new Uint8Array(d)),content:new Uint8Array(v),_:s,O:i}}}"undefined"!=typeof exports&&(exports.K=g,exports.L=class{W;Y;q;Z;j;J;X;constructor(r,t){if(null==t)throw new Error("Critical error !");this.W=t,this.Y=!1,this.q=r,this.Z=void 0,this.j=void 0,this.J=new E(Math.random()),this.X=new E(Math.random())}$(){if(null!=this.Z||this.Y)throw new Error("Critical error !");for(var r=C(this.J.u),t=C(this.J.u),i=new Uint8Array(this.J.u/8*2),e=t.k.length,s=0;s<e;s++)i[s]=t.k[s],i[e+s]=r.k[s];new Uint8Array(this.J.u/8);this.J.g(this.W,t.H),n=[];for(var n,o=0,s=0;s<r.k.length;)o=(o+this.J.M())%this.q.length,s=a(this.q[o],r.k,s,n);return this.J.C(n),this.Z=0,null!=this.j&&(this.Y=!0),i.buffer}rr(r){if(null!=this.j||this.Y)throw new Error("Critical error !");var t=new Uint8Array(r);if(t.length!=this.X.u/8*2)throw new Error("Critical error !");for(var i={H:new Uint8Array(this.X.u),k:new Uint8Array(this.X.u/8)},e={H:new Uint8Array(this.X.u),k:new Uint8Array(this.X.u/8)},s=i.k.length,n=0;n<s;n++)e.k[n]=t[n],p(t[n],e.H,8*n),i.k[n]=t[s+n],p(t[s+n],i.H,8*n);new Uint8Array(this.X.u/8);this.X.g(this.W,e.H),o=[];for(var o,h=0,n=0;n<i.k.length;)h=(h+this.X.M())%this.q.length,n=a(this.q[h],i.k,n,o);this.X.C(o),this.j=0,null!=this.Z&&(this.Y=!0)}encode(r){if(!this.Y)throw new Error("Critical error !");for(var t=new Uint8Array(r),i=(new Uint8Array(r.byteLength),[]),e=0;e<t.byteLength;)this.Z=(this.Z+this.J.M())%this.q.length,e=s(this.q[this.Z],t,e,i);return new Uint8Array(i).buffer}decode(r){if(!this.Y)throw new Error("Critical error !");for(var t=new Uint8Array(r),i=(new Uint8Array(r.byteLength),[]),e=0;e<t.byteLength;)this.j=(this.j+this.X.M())%this.q.length,e=a(this.q[this.j],t,e,i);return new Uint8Array(i).buffer}},exports.tr=w,exports.ir=f,exports.er=u,exports.sr=U,exports.nr=l,exports.hr=d,exports.ar=v);const T=require("fs"),b=require("path"),m=require("readline"),M=m.createInterface({input:process.stdin,output:process.stdout}),N=(M.input.on("keypress",function(r,t){var i=M.line.length;m.moveCursor(M.output,-i,0),m.clearLine(M.output,1);for(var e=0;e<i;e++)M.output.write("*")}),this);d=process.argv.slice(2);const S=d[0],F=d[1],I=d[2];null!=S&&null!=F&&null!=I||process.exit(1);b.basename(F);M.question("deballage",function(e){T.readFile(S,(r,t)=>{if(r)throw r;var i=new N.K(t);T.readFile(F,(r,t)=>{if(r)throw r;r=i.decode(t,e,N.hr),t=r.content,r=r.filename,r=b.resolve(I,r);T.writeFile(r,t,{ur:"wx"},r=>{if(r)throw r;process.exit(0)})})})});